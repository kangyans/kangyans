name: Update README with Blog Posts

on:
  schedule:
    - cron: '0 * * * *'  # Runs every hour
  push:
    branches:
      - main

jobs:
  update-readme:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2

      - name: Fetch Blog Posts
        run: |
          curl -s https://pubmed.ncbi.nlm.nih.gov/rss/search/10AkQ1Iw49REj1DNt0af-br0DDs5L7DHO_vAdAJJclIB5tpQlV/?limit=15&utm_campaign=pubmed-2&fc=20241220222625 | xq -r '.rss.channel.item[] | "- [" + .title + "](" + .link + ")"' > blog1-posts.txt
          curl -s https://pubmed.ncbi.nlm.nih.gov/rss/search/1Li5J1cBG7VByIPjgHDgURIGANnZJ6b2h5KFAUmSjYYU-ndAis/?limit=15&utm_campaign=pubmed-2&fc=20241220222648 | xq -r '.rss.channel.item[] | "- [" + .title + "](" + .link + ")"' > blog2-posts.txt

      - name: Update README
        run: |
          sed -i '/## Blog 1: Tech Insights/,$d' README.md
          echo "## Spiral" >> README.md
          cat blog1-posts.txt >> README.md
          echo "" >> README.md
          echo "## Low Rank" >> README.md
          cat blog2-posts.txt >> README.md

      - name: Commit and Push Changes
        run: |
          git config --global user.name kangyans
          git config --global user.email wrr6ps@virginia.edu
          git add README.md
          git commit -m 'Update README with latest blog posts'
          git push
